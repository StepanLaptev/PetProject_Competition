# Описание
*Проект сделан на основе соревнований: https://zindi.africa/competitions/ai4d-lab-tanzania-tourism-classification-challenge/data

Проект разделен на два ноутбука:
* EDA + preprocessing data
* Modeling(Train + Predict)

Набор данных описывает актуальную информацию о туристических расходах, собранных 
        Национальным бюро статистики (НБС) Танзании. Набор данных был собран, чтобы лучше понять состояние сектора 
        туризма и предоставить инструмент, который будет обеспечить рост отрасли.
        Необходимо классифицировать диапазон расходов, которые турист (тур.группа) тратит в Танзании. 
        Модель может использоваться различными туроператорами и Советом по туризму Танзании, 
        чтобы автоматически помочь туристам со всего мира оценить свои расходы перед посещением Танзании. 

**Target:** классификация расходов туристических групп предполагает 6 категорий: ***Highest Cost***, ***Higher Cost***, 
***High Cost***, ***Normal Cost***, ***Low Cost***, ***Lower Cost***. 

Показателем оценки для этой задачи является **logloss**

# Признаки
- Tour_ID - Unique identifier for each tourist (Уникальный идентификатор для каждого туриста)
- country - Страна, из которой приехал турист
- age_group - Возрастная группа туриста
- travel_with - Отношение людей, с которыми путешествуют туристы по Танзании
- total_female - количество женщин в одной группе
- total_male - количество мужчин в одной группе
- purpose - Цель посещения Танзании
- main_activity - Основное направление туризма в Танзании
- info_source - Источник информации о туризме в Танзании
- tour_arrangment - Организация посещения Танзании
- package_transport_int - Если турпакет включает международные перевозки
- package_accomodation - Если в турпакет входит услуга проживания
- package_food - Если в турпакет включено питание
- package_transport_tz - Если турпакет включает транспортное обслуживание в пределах Танзании
- package_sightseeing - Если турпакет включает экскурсионное обслуживание
- package_guided_tour - Если турпакет включает гида
- package_insurance - если турпакет включает страховку
- night_mainland - Количество ночей, проведенных туристом на материковой части Танзании
- night_zanzibar - Количество ночей, проведенных туристом на Занзибаре *Занзибар - остров
- first_trip_tz - Если бы это была первая поездка в Танзанию)
- cost_category - Диапазон расходов, которые турист тратит в Танзании

# Первый ноутбук: EDA + preprocessing data
1. Было предварительно обработаны данные: заполнены пропуски, исправлены ошибки, изменены типы данных.
Были подготовлены датасеты для последующего обучения на них моделей
2. Были рассмотрены гипотезы: зависимость target от признаков, выявление закономерностей, распределение признаков и т.д.
Был выявлен дисбаланс классов.

# Второй ноутбук: Modeling
Так как задача относится к многоклассовой классификации, то были выбраны следующие модели для обучения:
* **LogisticRegression** (ovr, ovo);
* **RandomForest**;
* **LGBMClassifier**;
* **CatBoostClassifier**;
* **StackingClassifier**;
* **Stacking (handmade)**.

Вначале были обучены алгоритмы на базовых параметрах. Далее были подобраны для каждого алгоритма наилучшие параметры с помощью **optuna**.
Помимо заявленной метрики logloss использовались метрики такие как: ROC-AUC, F1-macro/micro, precision-macro/micro, 
recall-macro/micro.

После отработки алгоритмов каждая модель проверялась на переобучение. Переобученные модели не использовались в Stacking.

В конце получены предсказания классов на test dataset в форме, диктуемой соревнованиями.

# Вывод
По итогам обучения моделей лучшие результаты по метрике logloss показали алгоритмы **StackingClassifier** и **LGBMClassifier
с подобранными параметрами**. StackingClassifier имеет лучший показатель метрики, но модель близка к переобучению. 
В соревнованиях можно использовать обе модели. Но если рассматривать в контексте запуска в производство, то лучше 
выбрать модель **LGBMClassifier с подобранными параметрами**, т.к. она не близка к переобучению.


